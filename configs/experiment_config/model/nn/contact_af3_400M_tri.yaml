name: contact_af3_400M_yes_tri

# Architecture parameters (matching ca_af3_400M_yes_tri)
token_dim: 1024  # dimension of the tokens in the sequence
nlayers: 18  # number of transformer layers
nheads: 16  # number of attn heads
residual_mha: True
residual_transition: True
parallel_mha_transition: False
use_attn_pair_bias: True

strict_feats: False

# Sequence features (no coordinate self-conditioning in contact map mode)
feats_init_seq: ["res_seq_pdb_idx", "chain_break_per_res"]
feats_cond_seq: ["time_emb", "fold_emb"]

# Feature extraction parameters
t_emb_dim: 256
dim_cond: 512
idx_emb_dim: 128
fold_emb_dim: 256
cath_code_dir: ${oc.env:DATA_PATH}/pdb_raw/
multilabel_mode: "sample"

# Pair features (contact_map_t is embedded directly in protein_transformer.py)
feats_pair_repr: ["rel_seq_sep", "contact_map_sc"]
feats_pair_cond: ["time_emb"]

# Pair feature params (kept for compatibility, though not used in contact map mode)
xt_pair_dist_dim: 64
xt_pair_dist_min: 0.1
xt_pair_dist_max: 3
x_sc_pair_dist_dim: 128
x_sc_pair_dist_min: 0.1
x_sc_pair_dist_max: 3
x_motif_pair_dist_dim: 128
x_motif_pair_dist_min: 0.1
x_motif_pair_dist_max: 3
seq_sep_dim: 127
pair_repr_dim: 512  # matching 400M size

update_pair_repr: True
update_pair_repr_every_n: 5  # matching 400M: 18 layers -> 4 pair updates
use_tri_mult: True

num_registers: 10
use_qkln: True

num_buckets_predict_pair: 39  # 38 bins between 3.25Ã…-50.75Ã… + 1 overflow (AlphaFold format)

# Contact map diffusion mode
contact_map_mode: True
contact_map_embed_dim: 64
predict_coords: False  # Whether to predict coordinates (for FAPE loss, logging)
non_contact_value: 0  # 0 -> contacts in {0,1} (sigmoid); -1 -> contacts in {-1,1} (tanh)
